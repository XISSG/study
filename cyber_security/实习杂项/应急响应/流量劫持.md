---
title: 流量劫持
updated: 2023-07-22 09:02:37Z
created: 2023-07-22 08:21:09Z
latitude: 30.57281600
longitude: 104.06680100
altitude: 0.0000
---

# 流量劫持
## DNS劫持
	本地DNS劫持，修改hosts文件、更改本地DNS设置
	路由器劫持，利用弱口令、固件漏洞等攻击路由器，等该路由器DNS设置
	中间人DNS攻击，拦截DNS查询请求，返回虚假IP
	恶意DNS服务器，直接攻击DNS服务器，更改DNS记录
	CDN缓存攻击造成用户侧无法正常访问站点
### 排查
查看本机hosts文件是否被修改
nslookup选择不同服务器进行排查
### 局域网中的DNS劫持处置
个人终端
+ 配置静态DNS服务器
+ 配置hosts文件，对静态IP域名进行绑定，并对hosts文件加锁
+ 修改路由器等设备弱口令，并对固件进行版本更新
### 企业DNS服务器劫持处置
隔离DNS服务器，开启备用DNS服务器
### 广域网DNS服务器劫持
更换DNS服务器设置
## HTTP劫持
链路层劫持
对流量进行检测，检测到为HTTP数据包是进行拦截处理
大致流程
1、获取网络流量，并标识出其中HTTP流量
2、拦截服务器响应包，对响应包进行篡改
3、将篡改之后的数据包抢先于正常数据包返回给客户端
4、客户端接收到篡改的数据包，将正常的数据包丢弃
网站被植入恶意代码
Rammit病毒类的恶意程序
网站统计类的JS文件
网页篡改
修改web容器进程如（IIS）
	JS脚本类
	中间件类
	恶意软件
## 链路层劫持
### TCP劫持
		
### ARP劫持
	蠕虫病毒
	开启arp防火墙
	开启arp防护